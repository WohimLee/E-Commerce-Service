
## 实施方案
好的！以下是针对 **阶段一：需求确认与数据准备** 的**具体实施步骤**，重点突出 **数据库选型建议** 与 **各数据库在本阶段的使用场景**。尽管阶段一以数据准备为主，但提前规划好数据库架构有助于后续阶段无缝衔接。

---

### 🧱 阶段一：需求确认与数据准备 — 具体实施步骤（含数据库选型说明）

#### ✅ 1. 明确MVP功能边界
- **聚焦能力**：仅支持基于商品描述的**单轮自然语言问答**。
  - 示例问题类型：材质（“这件衣服是纯棉的吗？”）、场景（“适合通勤穿吗？”）、尺码（“160cm穿什么码？”）、价格（“多少钱？”）、功能（“显瘦吗？”）。
- **排除能力**：
  - 个性化（无用户ID/行为数据）
  - 多轮对话（不维护上下文）
  - 图像/语音输入
- **输出**：撰写《MVP功能说明书》，明确输入/输出格式、支持/不支持的query类型。

> ✅ **数据库关联说明**：此阶段不直接使用数据库，但需为后续**向量库（Milvus）** 和**结构化属性库（MySQL/ES）** 预留字段设计。

---

#### ✅ 2. 清洗与结构化商品数据

##### 步骤 2.1：原始数据加载
- 从数据源（如数仓、API、CSV）加载商品数据。
- **保留所有原始字段**：`skuid`, `spuid`, `brand_name`, `group_name`, `price`, `sales`, `product_name`, `marketing_attributes`, `product_description`。

##### 步骤 2.2：构建RAG“知识单元”
- **合并文本**：
  ```python
  knowledge_text = f"{product_name}。{marketing_attributes}。{product_description}"
  ```
- **示例**（skuid=858514）：
  > "儿童短袖衬衫男童女童24夏季新款小童宝宝纯棉外套薄上衣。颜色为咖调CC抱,尺码为120cm。WOOBABY 儿童短袖衬衫男童女童夏季外套，100%纯棉面料……"

##### 步骤 2.3（可选）：提取结构化属性
- 使用规则或简单NLP从 `product_description` 中提取：
  - **颜色**（如“灰色”、“画布白”）
  - **尺码**（如“S”、“120cm”、“42”）
  - **季节**（如“春季”、“秋冬”）
  - **材质成分**（如“100%纯棉”、“90%白鸭绒”）
- **存储建议**：在清洗后的JSON/CSV中新增结构化字段（如 `color`, `size`, `season`, `material`）。

> 🗄️ **数据库选型与使用场景说明**：
> - **MySQL**（推荐）：
>   - **用途**：存储**结构化商品主数据**（skuid为主键）。
>   - **字段**：`skuid`, `brand_name`, `group_name`, `price`, `color`, `size`, `season` 等。
>   - **优势**：支持精确过滤（如 `WHERE group_name='连衣裙' AND price < 1000`），为阶段二/三的**混合检索**提供基础。
> - **Elasticsearch**（可选，阶段二引入）：
>   - 本阶段**不需部署**，但可按ES Mapping格式设计字段（如 `text` 类型用于全文搜索，`keyword` 用于聚合）。
>   - 后续可用于**关键词召回**（如“小黑裙” → 精准匹配 `product_name`）。

##### 步骤 2.4：去重与过滤
- 以 `skuid` 为唯一键，去除重复。
- 过滤条件：
  - `product_description` 为空或长度 < 10
  - `price <= 0` 或异常值
- **保留有效商品记录**（预计数千～数万条）。

##### 步骤 2.5：输出清洗后知识库
- **格式**：JSONL（每行一个JSON对象）或 CSV
- **必含字段**：
  ```json
  {
    "skuid": 858514,
    "knowledge_text": "儿童短袖衬衫...纯棉...",
    "brand_name": "WOOBABY",
    "group_name": "儿童衬衫",
    "price": 469.0,
    "color": "咖调CC抱",
    "size": "120cm",
    "season": "夏季"
  }
  ```

> 📌 **注意**：**Milvus / Neo4j / Redis 在本阶段不使用**。
> - Milvus：阶段二用于向量索引
> - Neo4j：本项目无强关系需求（如“搭配推荐”），暂不需
> - Redis：阶段四用于缓存query结果

---

#### ✅ 3. 构造测试问答对（50–100条）

##### 步骤 3.1：问题分类覆盖
- 参照你之前转化的服饰行业问题，覆盖：
  - 功效/功能（显瘦、保暖、防滑）
  - 人群/场景（小个子、宝宝、通勤）
  - 材质/成分（纯棉、亚麻、90%白鸭绒）
  - 尺码/价格/品牌
  - 混合意图（“适合160cm微胖女生的春季连衣裙”）

##### 步骤 3.2：标准答案（Ground Truth）格式
- **答案必须可从 knowledge_text 中提取**，避免引入外部知识。
- **优先返回具体信息**（如“213g”），其次返回商品名+skuid。
- 示例：
  ```json
  {
    "question": "波司登那件羽绒服充绒量多少？",
    "answer": "213g",
    "skuid": 671571
  }
  {
    "question": "有没有适合小孩子的纯棉衬衫？",
    "answer": "WOOBABY 儿童短袖衬衫",
    "skuid": 858514
  }
  ```

##### 步骤 3.3：输出评估集
- 格式：JSON 或 CSV
- 字段：`question`, `answer`, `skuid`, `category`（如“材质”、“尺码”）

---

#### 📦 阶段一最终产出物清单
| 产出物 | 格式 | 用途 |
|--------|------|------|
| 清洗后商品知识库 | JSONL / CSV | 阶段二向量索引输入 |
| 测试问答评估集 | JSON / CSV | 阶段三效果评估 |
| MVP功能说明书 | Markdown / Word | 对齐团队预期 |

---

### 🔑 数据库选型总结（阶段一视角）

| 数据库 | 本阶段是否使用 | 后续用途 | 建议 |
|--------|----------------|--------|------|
| **MySQL** | ✅（间接） | 存储结构化商品元数据，支持过滤/排序 | **必须准备**，设计好schema |
| **Elasticsearch** | ❌ | 阶段二/三关键词检索 | 暂不部署，但字段设计需兼容 |
| **Milvus** | ❌ | 阶段二向量检索 | 暂不部署 |
| **Redis** | ❌ | 阶段四缓存 | 暂不部署 |
| **Neo4j** | ❌ | 无强关系需求 | 暂不考虑 |

---

下一步建议：完成阶段一后，可直接用清洗后的 `knowledge_text` + `skuid` 等字段，进入 **阶段二的 Milvus 向量索引构建**。

如需我协助你：
- 设计 MySQL 表结构
- 编写数据清洗脚本（Python）
- 生成完整的测试问答对（50+条）

请随时告知！