## Step 2

### 第 2 步：梳理数据和字段设计

#### 1 字段清单

**原始字段（来自 opensearch_product_data.jsonl）**
- `skuid`：SKU 唯一 ID
- `spuid`：SPU 唯一 ID（同款不同规格聚合用）
- `brand_name`：品牌名称
- `group_name`：类目/品类（连衣裙、羽绒服、儿童衬衫…）
- `product_name`：商品标题
- `marketing_attributes`：营销属性文案（颜色为××、尺码为×× 等）
- `product_description`：长描述/详情文案
- `price`：价格
- `sales`：销量（当前样本多为 0，可作为预留字段）

**从文案中抽取/补充的业务字段（后续由规则或 LLM 抽取）**
- `color`：颜色（灰色、黑色、茶绿…）
- `size`：尺码（S、L、120cm、40…）
- `season`：季节（春、夏、秋、冬、多季节）
- `scene`：场景（商务通勤、休闲、运动、校园、聚会、度假…）
- `people_gender`：人群性别（男、女、童装、男女通用）
- `age_range`：年龄段（幼童、中大童、青少年、成人…）
- `material`：主要面料/材质（棉、聚酯纤维、鸭绒、皮革…）
- `style`：风格（通勤、赫本风、国潮、户外山系、简约…）
- `elasticity`：弹性（无弹、微弹、弹力）
- `thickness`：厚薄（薄、适中、加厚）
- `category_l1`：一级类目（服饰、鞋靴、箱包…）
- `category_l2`：二级类目（连衣裙、半身裙、外套、跑步鞋…）
- `price_bucket`：价格分层（0–199、200–499、500–999、1000+ 等，用于运营分析/排序）
- `status`：上下架状态（on_shelf/off_shelf，后续从业务库补充）
- `created_at` / `updated_at`：数据生成与更新时间（用于增量同步）

#### 2 目标 schema 设计（示例）

以“逻辑 schema”为主，后续映射到 MySQL 表和搜索引擎索引。

```yaml
product:
  # 主键 & 基础标识（结构化）
  skuid:
    type: bigint
    role: primary_key
    storage: mysql, es_keyword
  spuid:
    type: bigint
    role: group_key
    storage: mysql, es_keyword

  # 基础业务属性（结构化）
  brand_name:
    type: string
    kind: enum/keyword
    use: filter, aggregation
  category_l1:
    type: string
    kind: enum/keyword
    use: filter, aggregation
  category_l2:
    type: string
    kind: enum/keyword
    use: filter, aggregation
  group_name:
    type: string
    kind: enum/keyword
    use: filter, aggregation
  price:
    type: float
    use: sort, filter, aggregation
  price_bucket:
    type: string
    kind: enum
    use: filter, aggregation
  sales:
    type: int
    use: sort, ranking
  status:
    type: enum   # on_shelf/off_shelf
    use: filter
  created_at:
    type: datetime
  updated_at:
    type: datetime

  # 可检索的属性维度（结构化）
  color:
    type: string
    kind: enum/keyword
    use: filter
  size:
    type: string
    kind: enum/keyword
    use: filter
  season:
    type: string
    kind: enum/keyword   # spring/summer/autumn/winter/multi
    use: filter, aggregation
  scene:
    type: string[]
    kind: enum_list
    use: filter, recommendation
  people_gender:
    type: string         # male/female/kids/unisex
    use: filter
  age_range:
    type: string         # 3-6岁、7-12岁、成人…
    use: filter
  material:
    type: string[]
    kind: enum_list
    use: filter, explanation
  style:
    type: string[]
    kind: enum_list
    use: filter, explanation
  elasticity:
    type: string         # none/light/medium/high
    use: filter
  thickness:
    type: string         # thin/regular/thick
    use: filter

  # 全文检索文本字段
  product_name:
    type: text
    use: search_title, boosting
  marketing_attributes:
    type: text
    use: search_attributes
  product_description:
    type: text
    use: search_description
  searchable_text:
    type: text
    source: product_name + marketing_attributes + product_description
    use: main_fulltext_search
```

#### 3 说明

后续实现时：
- MySQL 中主要落地上述结构化字段和原始文案字段；
- 搜索引擎索引中复用这些字段，并将结构化字段映射为 keyword/float 等类型，searchable_text、product_name 等映射为 text，用于全文检索。