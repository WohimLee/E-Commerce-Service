## 落地方案

按“先清目标→再做数据→再做检索→最后做智能对话”的路线，会比较稳。可以按下面步骤落地：

#### 第 1 步：明确 MVP 场景和边界

- 只选一个清晰目标，比如“基于现有商品数据的智能导购+商品问答”，先支持服饰大类。

- 写一页文档：目标用户是谁、典型问题 20 条（如“预算 1000 左右的春季通勤连衣裙有哪些？”）、成功标准（命中率、点击率等）

#### 第 2 步：梳理数据和字段设计

- 通读 opensearch_product_data.jsonl，列一个字段清单：已有字段（brand_name、group_name、price…）+ 你希望检索/过滤用到的业务字段（季节、场景、风格、人群、材质、尺码等）。

- 设计一个目标 schema：哪些是结构化（枚举/数值），哪些是全文检索文本（标题、长描述），先写成表格或 YAML/JSON。

#### 第 3 步：做一版数据清洗与补充标签

- 写脚本读取 jsonl，做基础清洗：去掉空字段、修正明显异常值、统一价格单位、统一品牌/类目命名。

- 从 marketing_attributes 和 product_description 中抽取关键属性（季节、场景、材质、风格、性别、年龄段等），先用规则/正则起步，不够再用 LLM 做批量标注。

- 把清洗+打标签后的结果写成新的 jsonl / 表格，准备导入搜索系统。

#### 第 4 步：在搜索引擎层（ElasticSearch）建索引与检索 API

##### 1 设计并创建索引 mapping
- 结构化字段（price、brand_name、group_name、season、scene…）用 keyword/float 等类型，方便过滤和聚合。
- 文本字段（product_name、product_description）用 text，配置分词器（中文可以选 IK 等）。

##### 2 写一个简单的后端服务（如 FastAPI）
- /search 接口：接收关键词+过滤条件，调用 ElasticSearch，返回商品列表。
- 支持分页、按照价格/销量排序。

##### 3 用 Postman / curl 验证几组典型电商查询是否能召回合理结果。

#### 第 5 步：升级为“智能检索”（重写 Query + 向量检索，可分两期）

##### 前期
- 写一个“自然语言 → 检索参数”的转换逻辑：从用户问题里解析出品类、价格区间、季节/场景关键词，然后拼成结构化 filter + keyword 查询。
##### 后期
- 给每个商品生成文本 embedding（标题+卖点+描述），存入 OpenSearch 的向量字段；
- 查询时同时做 BM25 + 向量检索，做简单融合打分，提高相似度召回。

#### 第 6 步：接入 LLM 做对话式导购（RAG）

- 设计系统提示词：明确“你是电商导购，答案只能基于检索到的商品信息，不要编造”。

- 对话流程：
    - 用户发问 → 调用你刚做好的检索接口 → 选 topN 商品（如 5–10 个）连同用户问题一起喂给 LLM → 让模型用自然语言解释与推荐。
    - 控制返回结构：推荐列表（含 sku/标题/价格/理由）+ 总结说明，方便前端展示。
- 先用 CLI 或简单 Web 页面调通整条链路，再考虑正式 UI。
#### 第 7 步：前端与交互设计

- 搭建一个最小页：左侧聊天窗口，右侧展示推荐商品卡片（图、标题、价格、标签）。

- 加上基础交互：点击商品可查看详情、继续问“有没有更便宜的”“换成儿童款”等，由前端把上下文问题发给后端。
#### 第 8 步：评估与迭代优化

- 做一份测试集：收集/自造 50–100 条典型用户问题，人工标记“期望商品/答案”。

- 对每次模型或检索策略修改：
    - 离线跑一遍测试集，记录召回准确率、满意度评分；
    - 在线埋点点击率、会话长度、用户是否继续浏览等。

- 根据错例回看：
    - 是数据标签不全？→ 优化抽取规则/打标签。
    - 是检索/排序问题？→ 调整 BM25/向量权重、添加更多过滤。
    - 是 LLM 表达问题？→ 调整 prompt，限制不要编造。
#### 第 9 步：技术与运营上收尾

- 技术：监控 QPS、延迟、调用成本（尤其是 LLM），加缓存（热门查询、热门商品）。
- 运营：梳理“推荐策略原则”、常见话术模板，和商品运营/品牌同事对齐，保证文案风格统一。